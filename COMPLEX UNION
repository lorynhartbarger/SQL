
SELECT
  CONCAT(ORDERNO,'ID') AS ORDER_ID,
  CUSTOMER_ID,
  PRODUCT_ID,
  DATE_FORMAT(TRANSACTION_DATE, '%Y-%m-%d') AS DATE,
  ROUND(SALE_PRICE,2) AS ROUNDED_SALE_AMNT,
  CASE
    WHEN BU_NAME = 'Charlotte' THEN 'Easter Region'
    WHEN BU_NAME = 'Los Angeles' THEN 'Western Region'
    ELSE 'Other Region'
  END AS REGION,
  DISCOUNT,
  SALES_PRICE*(1-DISCOUNT) AS DISCOUNTED_PRICE
FROM (
  SELECT 
    ORDERNO, 
    CUSTOMER_ID, 
    PRODUCT_ID, 
    TRANSACTION_DATE,
    SALES_PRICE,
    DISCOUNT, 
    'Eastern Region' as REGION
  FROM CHARLOTTE_SALES
  
  UNION
  
  SELECT 
    ORDERNO, 
    CUSTOMER_ID, 
    PRODUCT_ID, 
    TRANSACTION_DATE,
    SALES_PRICE,
    DISCOUNT, 
    'Western Region' as REGION
  FROM LA_SALES 
    ) NORTH_AMERICAN_SALES
  WHERE TRANSACTION_DATE >= '2023-01-01'
  ORDER BY TRANSACTION_DATE DESC;
  
